const free_shipping_svg = `
<svg
	width="42"
	height="44"
	viewBox="0 0 42 44"
	fill="none"
	xmlns="http://www.w3.org/2000/svg"
    class="free-shipping-elm"
>
	<rect
		width="42"
		height="44"
		rx="21"
		fill="white"
	/>
	<path
		fill-rule="evenodd"
		clip-rule="evenodd"
		d="M41.5555 13.7092H40.7917C37.4954 6.05991 29.7755 0.691998 20.7774 0.691998C11.7799 0.691998 4.06016 6.0599 0.763837 13.7092H0C3.33687 5.66848 11.3825 0 20.7774 0C30.1729 0 38.2186 5.66848 41.5555 13.7092ZM0.0111824 30.3171H0.77544C4.07825 37.9527 11.7905 43.308 20.7774 43.308C29.7649 43.308 37.4773 37.9527 40.7801 30.3171H41.5444C38.2007 38.3442 30.1624 44 20.7774 44C11.393 44 3.35482 38.3442 0.0111824 30.3171ZM20.7773 40.5919C28.1956 40.5919 34.6185 36.4095 37.73 30.3171H36.9371C33.8842 36.0144 27.7931 39.8999 20.7773 39.8999C13.7615 39.8999 7.67068 36.0144 4.61802 30.3171H3.82506C6.9364 36.4095 13.3589 40.5919 20.7773 40.5919ZM4.60363 13.7092H3.81133C6.91747 7.60288 13.348 3.40878 20.7773 3.40878C28.2065 3.40878 34.6374 7.60288 37.7438 13.7092H36.9515C33.9034 7.99794 27.8042 4.10078 20.7773 4.10078C13.7504 4.10078 7.6515 7.99793 4.60363 13.7092ZM35.9566 15.9575V13.9375H30.0416V23.0089H35.9566V20.989H32.6118V19.3545H35.563V17.4377H32.6118V15.9575H35.9566ZM22.1939 23.0089H28.1096V20.989H24.7649V19.3545H27.7161V17.4377H24.7649V15.9575H28.1096V13.9375H22.1939V23.0089ZM17.8751 16.9865C17.8751 16.4204 17.521 16.0474 16.8263 16.0474H15.5538V17.9394H16.8263C17.521 17.9394 17.8751 17.6044 17.8751 16.9865ZM18.4521 19.4701L20.5378 23.0089H17.6649L15.8289 19.6631H15.5538V23.0089H12.9822V13.9375H17.0358C19.3309 13.9375 20.4849 15.224 20.4849 16.8453C20.4849 18.0293 19.8289 19.0583 18.4521 19.4701ZM5.30591 13.9375H11.575V15.9443H7.87689V17.5401H10.6052V19.4576H7.87689V23.0089H5.30591V13.9375ZM5.11373 28.3461V28.4137C5.11373 29.3337 5.90208 29.9289 7.08679 29.9289C8.25125 29.9289 9.04664 29.3535 9.04664 28.4673C9.04664 27.5212 8.12834 27.2598 7.59675 27.1084C7.55446 27.0964 7.51462 27.0851 7.47788 27.0741C6.72565 26.8499 6.45788 26.7485 6.45788 26.5053C6.45788 26.3025 6.64638 26.1739 6.95731 26.1739C7.4268 26.1739 7.67959 26.4649 7.67959 26.7081V26.7625C7.67959 26.7971 7.73068 26.8161 7.817 26.8161H8.88016C8.96737 26.8161 9.01757 26.7699 9.01757 26.6883V26.6537C9.01757 25.7131 8.14203 25.0849 7.00752 25.0849C5.93027 25.0849 5.12078 25.6455 5.12078 26.5193C5.12078 27.4929 6.13286 27.8515 6.80493 28.0411C6.87608 28.0611 6.94408 28.0794 7.00847 28.0967C7.42236 28.208 7.68752 28.2794 7.68752 28.5019C7.68752 28.6297 7.59239 28.8399 7.18809 28.8399C6.73975 28.8399 6.45084 28.5893 6.45084 28.3593V28.2843C6.45084 28.2447 6.39975 28.2167 6.31342 28.2167H5.25027C5.16394 28.2167 5.11373 28.2645 5.11373 28.3461ZM13.449 25.1385H12.3647C12.2775 25.1385 12.2272 25.1863 12.2272 25.2671V26.8771L12.1691 26.9323H11.0848L11.0276 26.8771V25.2671C11.0276 25.1863 10.9765 25.1385 10.8901 25.1385H9.80496C9.71864 25.1385 9.66756 25.1863 9.66756 25.2671V29.7467C9.66756 29.8267 9.71864 29.8753 9.80496 29.8753H10.8901C10.9765 29.8753 11.0276 29.8267 11.0276 29.7467V28.0749L11.0848 28.0205H12.1691L12.2272 28.0749V29.7467C12.2272 29.8267 12.2775 29.8753 12.3647 29.8753H13.449C13.5362 29.8753 13.5864 29.8267 13.5864 29.7467V25.2671C13.5864 25.1863 13.5362 25.1385 13.449 25.1385ZM14.23 29.7467V25.2671C14.23 25.1863 14.2802 25.1385 14.3665 25.1385H15.4508C15.538 25.1385 15.5891 25.1863 15.5891 25.2671V29.7467C15.5891 29.8267 15.538 29.8753 15.4508 29.8753H14.3665C14.2802 29.8753 14.23 29.8267 14.23 29.7467ZM18.2776 26.2283C18.6326 26.2283 18.8713 26.4245 18.8713 26.7221C18.8713 27.0123 18.6326 27.2027 18.2776 27.2027H17.6928L17.6346 27.1475V26.2819L17.6928 26.2283H18.2776ZM18.4371 28.2167C19.5073 28.2167 20.2225 27.6083 20.2225 26.6957C20.2225 25.7617 19.5363 25.1385 18.5022 25.1385H16.4129C16.3257 25.1385 16.2755 25.1863 16.2755 25.2671V29.7467C16.2755 29.8267 16.3257 29.8753 16.4129 29.8753H17.4981C17.5835 29.8753 17.6346 29.8267 17.6346 29.7467V28.2719L17.6928 28.2167H18.4371ZM23.3528 26.7221C23.3528 26.4245 23.115 26.2283 22.7601 26.2283H22.1743L22.117 26.2819V27.1475L22.1743 27.2027H22.7601C23.115 27.2027 23.3528 27.0123 23.3528 26.7221ZM24.7049 26.6957C24.7049 27.6083 23.9897 28.2167 22.9195 28.2167H22.1743L22.117 28.2719V29.7467C22.117 29.8267 22.066 29.8753 21.9796 29.8753H20.8953C20.8081 29.8753 20.7579 29.8267 20.7579 29.7467V25.2671C20.7579 25.1863 20.8081 25.1385 20.8953 25.1385H22.9847C24.0188 25.1385 24.7049 25.7617 24.7049 26.6957ZM25.2619 25.2671V29.7467C25.2619 29.8267 25.3129 29.8753 25.3993 29.8753H26.4836C26.5708 29.8753 26.621 29.8267 26.621 29.7467V25.2671C26.621 25.1863 26.5708 25.1385 26.4836 25.1385H25.3993C25.3129 25.1385 25.2619 25.1863 25.2619 25.2671ZM27.3289 29.7467V25.2671C27.3289 25.1863 27.38 25.1385 27.4663 25.1385H28.5074L28.6739 25.2267L30.0982 27.4665L30.1704 27.4459L30.1625 25.2671C30.1625 25.1789 30.2136 25.1385 30.3008 25.1385H31.3851C31.4714 25.1385 31.5225 25.1863 31.5225 25.2671V29.7467C31.5225 29.8267 31.4714 29.8753 31.3851 29.8753H30.344L30.1775 29.7871L28.7461 27.5069L28.6739 27.5201L28.6889 29.7467C28.6889 29.8341 28.6378 29.8753 28.5506 29.8753H27.4663C27.38 29.8753 27.3289 29.8267 27.3289 29.7467ZM32.1657 26.8647V28.1433C32.1657 29.2117 32.9611 29.9289 34.1617 29.9289C35.3543 29.9289 36.1488 29.2249 36.1488 28.2109V27.3107C36.1488 27.2299 36.0986 27.1821 36.0123 27.1821H34.1828C34.0956 27.1821 34.0454 27.2299 34.0454 27.3107V28.0691C34.0454 28.1491 34.0956 28.1969 34.1828 28.1969H34.7686L34.8258 28.2505V28.3181C34.8258 28.6569 34.5668 28.8399 34.2189 28.8399C33.8358 28.8399 33.5248 28.5761 33.5248 28.1829V26.8309C33.5248 26.4377 33.7776 26.1739 34.1617 26.1739C34.573 26.1739 34.7976 26.4377 34.7976 26.7221V26.7485C34.7976 26.7699 34.8478 26.7823 34.9342 26.7823H36.0123C36.0986 26.7823 36.1488 26.7419 36.1488 26.6743C36.1488 25.8021 35.3543 25.0849 34.1617 25.0849C32.9611 25.0849 32.1657 25.7955 32.1657 26.8647Z"
		fill="#B780F0"
	/>
</svg>
`;

const style = `
<style>
    .free-shipping-elm{
        position: absolute;
        top: 10px;
        left: 10px;
        z-index: 5;
    }
    .save-elm{
        border: 1px solid #B780F0;
        background: #B780F0;
        margin-left: 8px;
        padding: 2px 4px;
        border-radius: 4px;
        font-size: 10px;
		line-height: 10px;
        font-weight: 700;
        color: white;
    }
	@media only screen and (max-width:480px){
		.save-elm{
			margin-left: 4px;
			font-size: 8px;
			line-height: 8px;
			padding: 2px;
			font-weight: 500;
		}
		.Product_product-previous-price__KJGV7{
			margin-left: 4px;
			font-size: 10px;
		}
		.Product_product-price__RQNb_{
			font-size: 10px;
		}
	}
</style>
`;

const new_elm_html = (price) => `
<span class="save-elm">
    SAVE
    $${price.toFixed(2)}
</span>
`;

const interval = setInterval(() => {
	const products = [
		...document.querySelectorAll('.Product_product-thumbnail__najOP'),
	];
	if (products.length > 0) {
		products.map((product) => {
			try {
				if (!product.querySelector('.ab-test-added')) {
					const current_price = product.querySelector(
						'.Product_product-price__RQNb_'
					);
					if (Number(current_price.innerText) >= 49) {
						product
							.querySelector('.Product_product-image__QSCCd')
							.insertAdjacentHTML('beforeend', free_shipping_svg);
					}
					const prev_price = product.querySelector(
						'.Product_product-previous-price__KJGV7'
					);
					if (current_price && prev_price) {
						prev_price.insertAdjacentHTML(
							'afterend',
							new_elm_html(prev_price.innerText - current_price.innerText)
						);
					}
					product.querySelector('div').classList.add('ab-test-added');
				}
			} catch (error) {
				console.log(error);
			}
		});
	}
}, 10);

const styleInterval = setInterval(() => {
	const head = document.querySelector('head');
	if (head) {
		head.insertAdjacentHTML('beforeend', style);
		clearInterval(styleInterval);
	}
}, 10);
